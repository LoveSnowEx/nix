# Rime schema
# encoding: utf-8

schema:
  schema_id: ls_double_pinyin
  name: ls_double_pinyin
  version: "0.1"
  author:
    - æ— åæ°
  description: |
    æœ™æœˆæ‹¼éŸ³ï¼‹å°é¹¤åŒæ‹¼æ–¹æ¡ˆã€‚
  dependencies:
    - cangjie5

switches:
  - name: ascii_mode
    reset: 1
    states: [ ä¸­, En ]
  - name: full_shape
    states: [ åŠå½¢, å…¨å½¢ ]
  - name: ascii_punct
    reset: 0
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]
  - name: s2tw
    reset: 1
    # å•“ç”¨ opencc å­—å½¢è½‰æ›ï¼Œä½†ä¸åœ¨é¸å–®ä¸­é¡¯ç¤ºã€‚
    # states: [ "ç®€åŒ–å­—", "æ•™æ¨™å­—" ]
  - name: t2tw
    reset: 1
    # å•“ç”¨ opencc å­—å½¢è½‰æ›ï¼Œä½†ä¸åœ¨é¸å–®ä¸­é¡¯ç¤ºã€‚æ­£ â†’ è‡º
    # states: [ "å‚³æ‰¿å­—", "æ•™æ¨™å­—" ]

engine:
  processors:
    - ascii_composer
    - recognizer
    - chord_composer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - echo_translator
    - punct_translator
    - script_translator
    - reverse_lookup_translator
    - table_translator@custom_phrase
  filters:
    - simplifier@s2tw  # ç°¡ç¹è½‰æ›
    - simplifier@t2tw  # æ­£ç¹è½‰æ›
    - uniquifier       # éæ¿¾é‡è¤‡çš„å€™é¸å­—ï¼Œæœ‰å¯èƒ½ä¾†è‡ªç°¡æ­£ç¹è½‰æ›
    - reverse_lookup_filter@comment_bopomo
    - reverse_lookup_filter@comment_cangjie
    - reverse_lookup_filter@comment_pinyin

# ä¿®æ”¹å€™é¸å–®æ¨™ç±¤ã€ä¿®æ”¹å€™é¸å–®å¤§å°
menu:
  alternative_select_labels: [ ï¼–, ï¼—, ï¼˜, ï¼™, ï¼ ]
  alternative_select_keys: 67890
  page_size: 5

style: # ä¿®æ”¹å€™é¸å–®æ¨™ç±¤æ ¼å¼
  label_format: ' %s '

speller:
  alphabet: "abcdefghijklmnopqrstuvwxyz12345,^./;"
  initials: "bpmfdtnlgkhjqxavorzcseyw"
  finals: "12345,^./;"
  delimiter: " '"
  algebra:
  # é è™•ç†
    - erase/^xx$/          # ç§»é™¤ã€xxã€‘ç·¨ç¢¼
    - xform/^r5$/er5/      # ã€œå…’
    - xform/v/Ã¼/           # v â†’ Ã¼
    - xform/^yu/yÃ¼/        # yue, yuan, yun, yung  â†’ Ã¼e, Ã¼an, Ã¼n, Ã¼ng
    - xform/^y([^iÃ¼])/yi$1/  # ya, yo, yao, yong â†’ yia, yio, yiao, yiong
    - xform/^wu?/wu/       # wu, w- â†’ u, u-
    - xform/iu/iou/        # è£œä¸Šæ¼éŸ³
    - xform/ui/uei/        # è£œä¸Šæ¼éŸ³
    - xform/iong/Ã¼ng/      # [jqx]iong â†’ [jqx]Ã¼ng
    - xform/ong/ung/       # ong â†’ ung
    - xform/uen/un/        # uen â†’ un
    - xform/^([jqx])u/$1Ã¼/ # å–æ¶ˆã„ã„‘ã„’çš„çœç•¥è¡¨ç¤ºæ³•
  # é–‹å§‹è½‰æ›è¼¸å…¥éµ
    - xform/iang/C/
    - xform/uang/C/
    - xform/iai/Z/
    - xform/ian/X/
    - xform/ing/B/
    - xform/Ã¼an/S/
    - xform/ang/D/
    - xform/eng/G/
    - xform/Ã¼ng/G/
    - xform/uai/Q/
    - xform/uan/W/
    - xform/ung/T/
    - xform/iou/N/
    - xform/iao/M/
    - xform/uei/P/
    - xform/in/V/
    - xform/an/S/
    - xform/en/F/
    - xform/Ã¼n/F/
    - xform/ie/Q/
    - xform/ia/E/
    - xform/un/R/
    - xform/er/R/
    - xform/ou/H/
    - xform/ao/J/
    - xform/ai/K/
    - xform/ei/L/
    - xform/ua/Y/
    - xform/ue/P/
    - xform/io/O/
    - xform/uo/O/
    - xform/Ã¼e/P/
    - xform/^([aeiouÃ¼])/0$1/
    - xform/^zh/a/
    - xform/^ch/v/
    - xform/^sh/o/
  # è¼¸å…¥éµè½‰æ›
    - xform/Ã¼/y/     # `Yéµ`è¼¸å…¥Ã¼
    - xform/^([ABCDEFGHIJKLMNOPQRSTUVWXYZ])/0$1/
    - xlit/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/ # ä»‹éŸ³ã€éŸ»æ¯ä¸€å¾‹å°å¯«
    - xform/^0/e/
  # è¼¸å…¥è²èª¿ï¼ˆä¸ç”¨æ•¸å­—éµï¼‰
    - derive/([a-z]{2})5/$1;/
    - derive/([a-z]{2})4/$1,/
    - derive/([a-z]{2})3/$1^/
    - derive|([a-z]{2})2|$1.|
    - derive|([a-z]{2})1|$1/|
  # çœç•¥è²èª¿
    - derive/([a-z]{2})\d/$1/

translator:
  enable_completion: true
  initial_quality: 0.99
  dictionary: terra_pinyin
  prism: double_bopomo
  preedit_format:
    - 'xform ([a-zA-Z]{2})(\/) ${1}1 '
    - 'xform ([a-zA-Z]{2})(\.) ${1}2 '
    - 'xform ([a-zA-Z]{2})(\^) ${1}3 '
    - 'xform ([a-zA-Z]{2})(,) ${1}4 '
    - 'xform ([a-zA-Z]{2})(;) ${1}5 '
    - xform/(?<=e)p/P/                  # ã„
    - xform/(?<=e)r/R/                  # ã„¦
    - xform/(?<=e)e/E/                  # ã„œ
    - xform/(?<=e)p/P/                  # ã„
    - xform/(?<=[nljqxy])p/YP/          # ã„‹ã„Œã„ã„‘ã„’ã„© + ã„ = ã„©ã„
    - xform/(?<=[jqxy])s/YS/            # ã„ã„‘ã„’ã„© + ã„¢ = ã„©ã„¢
    - xform/(?<=[jqxy])f/YF/            # ã„ã„‘ã„’ã„© + ã„£ = ã„©ã„£
    - xform/(?<=[jqxy])g/YG/            # ã„ã„‘ã„’ã„© + ã„¥ = ã„©ã„¥
    - xform/(?<=[jqxy])e/IA/            # ã„ã„‘ã„’ã„§ + ã„š = ã„§ã„š
    - xform/(?<=[bpmdtnljqxy])q/IP/     # ã„…ã„†ã„‡ã„‰ã„Šã„‹ã„Œã„ã„‘ã„’ã„§ + ã„ = ã„§ã„
    - xform/(?<=[nljqxy])c/ID/          # ã„‹ã„Œã„ã„‘ã„’ã„§ + ã„¤ = ã„§ã„¤
    - xform/(?<=y)o/IO/                 # ã„§ã„›
    - xform/(?<=y)z/IK/                 # ã„§ã„
    - xform/(?<=[a-z])n/IH/             # ã„§ã„ 
    - xform/(?<=[a-z])m/IJ/             # ã„§ã„¡
    - xform/(?<=[a-z])x/IS/             # ã„§ã„¢
    - xform/(?<=[a-z])v/IF/             # ã„§ã„£
    - xform/(?<=[a-z])b/IG/             # ã„§ã„¥
    - xform/(?<=[gkhaow])y/UA/          # ã„¨ã„š
    - xform/(?<=[dtnlgkhavorzcsw])o/UO/ # ã„¨ã„›
    - xform/(?<=[gkhavow])q/UK/         # ã„¨ã„
    - xform/(?<=[dtgkhavorzcsw])p/UL/   # ã„¨ã„Ÿ
    - xform/(?<=[a-z])c/UD/             # ã„¨ã„¤
    - xform/(?<=[a-z])w/US/             # ã„¨ã„¢
    - xform/(?<=[a-z])r/UF/             # ã„¨ã„£
    - xform/(?<=[a-z])t/UG/             # ã„¨ã„¥
    - xform/(?<=[a-z])a/A/              # ã„š
    - xform/(?<=[a-z])o/O/              # ã„›
    - xform/(?<=[a-z])e/E/              # ã„œ
    - xform/(?<=[a-z])p/P/              # ã„
    - xform/(?<=[a-z])i/I/              # ã„§
    - xform/(?<=[a-z])u/U/              # ã„¨
    - xform/(?<=[a-z])y/Y/              # ã„©
    - xform/(?<=[a-z])k/K/              # ã„
    - xform/(?<=[a-z])l/L/              # ã„Ÿ
    - xform/(?<=[a-z])h/H/              # ã„ 
    - xform/(?<=[a-z])j/J/              # ã„¡
    - xform/(?<=[a-z])s/S/              # ã„¢
    - xform/(?<=[a-z])f/F/              # ã„£
    - xform/(?<=[a-z])d/D/              # ã„¤
    - xform/(?<=[a-z])g/G/              # ã„¥
    - xform/(?<=[bpmfdtnlgkhjqxavorzcsiuy])$/â—Œ/
    - xform/w$/U/
    - xform/(?<=[avorzcs])I$/ğŸ˜¬/
    - xlit/bpmfdtnlgkhjqxavorzcse/ã„…ã„†ã„‡ã„ˆã„‰ã„Šã„‹ã„Œã„ã„ã„ã„ã„‘ã„’ã„“ã„”ã„•ã„–ã„—ã„˜ã„™â—Œ/
    - xlit/IUYAOEPKLJHSFDGR 12345/ã„§ã„¨ã„©ã„šã„›ã„œã„ã„ã„Ÿã„ ã„¡ã„¢ã„£ã„¤ã„¥ã„¦â£Ë‰ËŠË‡Ë‹Ë™/
    - xform/[a-z]//
    - xform/â—Œ(?!$)//

# reverse_lookup: # å®šç¾©ç”¨å€‰é ¡æŸ¥è©¢é›™ç¢¼æ³¨éŸ³
#   dictionary: cangjie5
#   enable_completion: true
#   prefix: "`"
#   suffix: "'"
#   tips: ã€”å€‰é ¡ã€•
#   preedit_format:
#     - "xlit|abcdefghijklmnopqrstuvwxyz|æ—¥æœˆé‡‘æœ¨æ°´ç«åœŸç«¹æˆˆåå¤§ä¸­ä¸€å¼“äººå¿ƒæ‰‹å£å°¸å»¿å±±å¥³ç”°é›£åœç¬¦|"
#   comment_format:
#   # é è™•ç†
#     - erase/^xx$/          # ç§»é™¤ã€xxã€‘ç·¨ç¢¼
#     - xform/^r5$/er5/      # ã€œå…’
#     - xform/v/Ã¼/           # v â†’ Ã¼
#     - xform/^yu/yÃ¼/        # yue, yuan, yun, yung  â†’ Ã¼e, Ã¼an, Ã¼n, Ã¼ng
#     - xform/^y([^iÃ¼])/yi$1/  # ya, yo, yao, yong â†’ yia, yio, yiao, yiong
#     - xform/^wu?/wu/       # wu, w- â†’ u, u-
#     - xform/iu/iou/        # è£œä¸Šæ¼éŸ³
#     - xform/ui/uei/        # è£œä¸Šæ¼éŸ³
#     - xform/iong/Ã¼ng/      # [jqx]iong â†’ [jqx]Ã¼ng
#     - xform/ong/ung/       # ong â†’ ung
#     - xform/uen/un/        # uen â†’ un
#     - xform/^([jqx])u/$1Ã¼/ # å–æ¶ˆã„ã„‘ã„’çš„çœç•¥è¡¨ç¤ºæ³•
#   # é–‹å§‹è½‰æ›è¼¸å…¥éµ
#     - xform/iang/C/
#     - xform/uang/C/
#     - xform/iai/Z/
#     - xform/ian/X/
#     - xform/ing/B/
#     - xform/Ã¼an/S/
#     - xform/ang/D/
#     - xform/eng/G/
#     - xform/Ã¼ng/G/
#     - xform/uai/Q/
#     - xform/uan/W/
#     - xform/ung/T/
#     - xform/iou/N/
#     - xform/iao/M/
#     - xform/uei/P/
#     - xform/in/V/
#     - xform/an/S/
#     - xform/en/F/
#     - xform/Ã¼n/F/
#     - xform/ie/Q/
#     - xform/ia/E/
#     - xform/un/R/
#     - xform/er/R/
#     - xform/ou/H/
#     - xform/ao/J/
#     - xform/ai/K/
#     - xform/ei/L/
#     - xform/ua/Y/
#     - xform/ue/P/
#     - xform/io/O/
#     - xform/uo/O/
#     - xform/Ã¼e/P/
#     - xform/^([aeiouÃ¼])/0$1/
#     - xform/^zh/a/
#     - xform/^ch/v/
#     - xform/^sh/o/
#   # è¼¸å…¥éµè½‰æ›
#     - xform/Ã¼/y/     # `Yéµ`è¼¸å…¥Ã¼
#     - xform/^([ABCDEFGHIJKLMNOPQRSTUVWXYZ])/0$1/
#     - xlit/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/ # ä»‹éŸ³ã€éŸ»æ¯ä¸€å¾‹å°å¯«
#     - xform/^0/e/
#     - derive/([a-z]{2})\d/$1/

# å®šç¾©åæŸ¥æ¿¾é¡
comment_bopomo:
  tags: [ none ]
  overwrite_comment: true
  dictionary: terra_pinyin
  comment_format:
    - xform/e?r5$/er5/
    - xform/iu/iou/
    - xform/ui/uei/
    - xform/ong/ung/
    - xform/(^|[ ])yi?/$1i/
    - xform/(^|[ ])wu?/$1u/
    - xform/iu/v/
    - xform/(^|[ ])([jqx])u/$1$2v/
    - xform/([iuv])n/$1en/
    - xform/zh/Z/
    - xform/ch/C/
    - xform/sh/S/
    - xform/ai/A/
    - xform/ei/I/
    - xform/ao/O/
    - xform/ou/U/
    - xform/ang/K/
    - xform/eng/G/
    - xform/an/M/
    - xform/en/N/
    - xform/er/R/
    - xform/eh/E/
    - xform/([iv])e/$1E/
    - xform/1//
    - xform/([a-zA-Z]+)5/5$1/
    - xform/([a-zA-Z1-5]+)($|[ ])/ã€”$1ã€•/
    - xform/([ZCSr])i(\d*)/$1$2/
    - xform/([zcs])i(\d*)/$1$2/
    - xlit/bpmfdtnlgkhjqxZCSrzcsiuvaoeEAIOUMNKGR2345/ã„…ã„†ã„‡ã„ˆã„‰ã„Šã„‹ã„Œã„ã„ã„ã„ã„‘ã„’ã„“ã„”ã„•ã„–ã„—ã„˜ã„™ã„§ã„¨ã„©ã„šã„›ã„œã„ã„ã„Ÿã„ ã„¡ã„¢ã„£ã„¤ã„¥ã„¦ËŠË‡Ë‹Ë™/

comment_cangjie:
  tags: [ none ]
  overwrite_comment: false
  dictionary: cangjie5
  comment_format:
    - xform/([^ ]+)($|[ ])/ã€”$1ã€•/
    - xlit|abcdefghijklmnopqrstuvwxyz|æ—¥æœˆé‡‘æœ¨æ°´ç«åœŸç«¹æˆˆåå¤§ä¸­ä¸€å¼“äººå¿ƒæ‰‹å£å°¸å»¿å±±å¥³ç”°é›£åœç¬¦|

comment_pinyin:
  tags: [ none ]
  overwrite_comment: false
  dictionary: terra_pinyin
  comment_format:
    - xform ([aeiou])(ng?|r)([1234]) $1$3$2
    - xform ([aeo])([iuo])([1234]) $1$3$2
    - xform a1 Ä
    - xform a2 Ã¡
    - xform a3 Ç
    - xform a4 Ã 
    - xform e1 Ä“
    - xform e2 Ã©
    - xform e3 Ä›
    - xform e4 Ã¨
    - xform o1 Å
    - xform o2 Ã³
    - xform o3 Ç’
    - xform o4 Ã²
    - xform i1 Ä«
    - xform i2 Ã­
    - xform i3 Ç
    - xform i4 Ã¬
    - xform u1 Å«
    - xform u2 Ãº
    - xform u3 Ç”
    - xform u4 Ã¹
    - xform v1 Ç–
    - xform v2 Ç˜
    - xform v3 Çš
    - xform v4 Çœ
    - xform/([nljqxy])v/$1Ã¼/
    - xform/eh[0-5]?/Ãª/
    - xform/([a-z]+)[0-5]/$1/
    - xform/(.+)($|[ ])/ã€”$1ã€•/

custom_phrase: # å®šç¾©ä½¿ç”¨è€…è©åº«
  dictionary: ""
  user_dict: custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 1

# è¨­å®šOpenCCå­—é«”è½‰æ›
t2tw: # æ­£å°è½‰æ›
  option_name: t2tw
  opencc_config: t2tw.json
  tips: char

s2tw: # ç°¡å°è½‰æ›
  option_name: s2tw
  opencc_config: s2tw.json

punctuator:
  import_preset: default

chord_composer:
  alphabet: ",."
  algebra:
    - xform|,[.]|^|
  prompt_format: # Ë‰ËŠË‡Ë‹Ë™
    - xform|\^|(Ë‡)â€¦â€¦|
    - xform|[.]|(ËŠ)ã€‚|
    - xform|,|(Ë‹)ï¼Œ|

# å®šç¾©åŠŸèƒ½éµ
editor:
  bindings:
    Return: commit_script_text  # ç›´æ¥è¼¸å‡ºæ³¨éŸ³
    BackSpace: revert    # ä¸€æ¬¡é€€å›ä¸€å€‹éŸ³ç¯€
    # ==========================
    # ä»¥ä¸‹ç‚ºé è¨­è¨­å®šï¼Œå¯è‡ªè¡Œä¿®æ”¹
    # confirm è¼¸å‡ºå€™é¸é …
    # commit_comment è¼¸å‡ºå€™é¸é …å‚™æ³¨
    # commit_raw_input è¼¸å‡ºåŸå§‹è¼¸å…¥æŒ‰éµ
    # commit_script_text è¼¸å‡ºæ³¨éŸ³é è¦½
    # commit_composition èªå¥æµå–®å­—ä¸Šå±
    # revert æ’¤æ¶ˆä¸Šæ¬¡è¼¸å…¥
    # back æŒ‰å­—ç¬¦å›é€€
    # back_syllable æŒ‰éŸ³ç¯€å›é€€
    # delete_candidate åˆªé™¤å€™é¸é …
    # delete å‘å¾Œåˆªé™¤
    # cancel å–æ¶ˆè¼¸å…¥
    # noop ç©º

# å®šç¾©æŒ‰éµç¶å®š
key_binder:
  import_preset: default
  bindings:
    - {accept: comma, send: comma, when: has_menu}
    - {accept: period, send: period, when: has_menu}
    - {accept: semicolon, send: semicolon, when: has_menu}

# recognizer:
#   import_preset: default
#   patterns:
#    reverse_lookup: "`[a-z]*'?$"
